<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:replace="component/config :: config"></th:block>
</head>
<body>
<div th:replace="component/header :: header"></div>
<div th:replace="component/nav :: nav"></div>
<div id="section">
    <table class="table table-dark">
        <tr>
            <th>번호</th>
            <td th:text="${board.id}"></td>
        </tr>
        <tr>
            <th>작성자</th>
            <td th:text="${board.boardWriter}"></td>
        </tr>
        <tr>
            <th>글 제목</th>
            <td th:text="${board.boardTitle}"></td>
        </tr>
        <tr>
            <th>글 비밀번호</th>
            <td th:text="${board.boardPass}"></td>
        </tr>
        <tr>
            <th>내용</th>
            <td th:text="${board.boardContents}"></td>
        </tr>
        <tr>
            <th>작성날짜</th>
            <td th:text="*{#temporals.format(board.createdAt, 'yyyy-MM-dd HH:mm:ss')}"></td>
        </tr>
        <tr th:if="${board.fileAttached==1}">
            <th>image</th>
            <td th:each="fileName:${board.storedFileName}">
                <img th:src="@{|/upload/${fileName}}" width="200" height="200" alt="">
            </td>
        </tr>
    </table>
    <div id="container">
        <button onclick="list_req()" class="btn btn-primary">목록</button>
        <button onclick="req('update')" class="btn btn-dark">수정</button>
        <button onclick="req('delete')" class="btn btn-danger">삭제</button>
    </div>
    <div id="pass-check">

    </div>
</div>
<div th:replace="component/footer :: footer"></div>
</body>
<script th:inline="javascript">
    const list_req=()=>{
        location.href="/board/";
    }
    const req=(type)=>{
        // type은 그냥 매개변수 이름임
        console.log("type",type);
        document.getElementById("pass-check").innerHTML="<input type=\"text\" placeholder=\"password\" id=\"password\">\n" +
            "        <button onclick=\"pass_check('"+type+"')\">확인</button>"
    }
    // const delete_req=()=>{
    //     document.getElementById("pass-check").innerHTML="<input type=\"text\" placeholder=\"password\" id=\"password\">\n" +
    //         "        <button onclick=\"delete_pass_check()\">확인</button>"
    // }
    const pass_check=(type)=>{
        console.log("pass_check type 변수 값", type);
        const password=document.getElementById("password").value;
        const passDB=[[${board.boardPass}]];
        const id = [[${board.id}]];
        if(password==passDB){
            if(type == "update"){
                location.href="/board/update/"+id;
            }else if(type == "delete"){
                axios({
                    method:"delete",
                    url:"/board/"+id
                }).then(res=>{
                    location.href="/board/";
                }).catch(err=>{
                    alert("삭제 실패");
                })
            }

        }else{
            alert("비밀번호가 일치하지 않습니다.")
        }
    }
    // 수정화면을 띄우기 위한 pass_check 메소드
    // 수정과 삭제를 합쳤다.


    // const delete_pass_check=()=>{
    //     const password=document.getElementById("password").value;
    //     const passDB=[[${board.boardPass}]];
    //     const id = [[${board.id}]];
    //     if(password==passDB){
    //         // location.href="/board/delete/"+id;
    //         axios({
    //             method:"delete",
    //             url:"/board/"+id
    //         }).then(res=>{
    //             location.href="/board";
    //         }).catch(err=>{
    //             alert("삭제 실패");
    //         })
    //     }else{
    //         alert("비밀번호가 일치하지 않습니다.")
    //     }
    // }
    // 수정화면을 띄우기 위한 pass_check 메소드
</script>
</html>